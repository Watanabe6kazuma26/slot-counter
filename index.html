<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ¤œè¨¼ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼</title>

<style>
body{
  font-family:sans-serif;
  background:#111;
  color:white;
  margin:0;
  padding:5px;
  font-size:12px;
}
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  border:1px solid #333;
  padding:4px;
  text-align:center;
}
button{
  padding:8px;
  margin:3px;
  border:none;
  border-radius:6px;
  font-size:13px;
}
.plus{
  background:#28a745;
  color:white;
  width:100%;
}
.refresh{
  background:#007bff;
  color:white;
  width:100%;
  padding:8px;
  margin:5px 0;
}
</style>
</head>
<body>

<h3>æ¤œè¨¼ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼</h3>

<button class="refresh" onclick="loadData()">ğŸ”„ æ›´æ–°</button>

<table>
<tr>
<th>çŠ¶æ…‹</th>
<th>å„ªé‡</th>
<th>å„ªé‡(BB)</th>
<th>å„ªé‡(reg)</th>
<th>åœ°ç„</th>
</tr>
<tbody id="tableBody"></tbody>
</table>

<script>

const GAS_URL = "https://script.google.com/macros/s/AKfycbzyLEP6QLUaBGQpepYz1VTTluWvdsfykcUKmDLdZM08kYkRPZ_ybVuuxQVMXDS0fG8/exec";

const rows = [
"å½é©å‘½1","å½é©å‘½2","å½é©å‘½3",
"ä¸‹ä½AT1","BB1","ä¸‹ä½ATå¾Œ1",
"BB2","ä¸‹ä½ATå¾Œ2","BB3"
];

const rowLabels = [
"å½é©å‘½ï¼ˆäºŒå›å‰å½é©å‘½orä¸‹ä½ATã§ãªã„ï¼‰",
"å½é©å‘½ï¼ˆ2å›å‰ãŒå½é©å‘½ï¼‰",
"å½é©å‘½ï¼ˆ2å›å‰ãŒä¸‹ä½ATï¼‰",
"ä¸‹ä½ATï¼ˆäºŒå›å‰å½é©å‘½orä¸‹ä½ATã§ãªã„ï¼‰",
"BBï¼ˆäºŒå›å‰å½é©å‘½orä¸‹ä½ATã§ãªã„ï¼‰",
"ä¸‹ä½ATå¾Œï¼ˆ2å›å‰ãŒå½é©å‘½ï¼‰",
"BBï¼ˆ2å›å‰ãŒå½é©å‘½ï¼‰",
"ä¸‹ä½ATå¾Œï¼ˆï¼’å›å‰ãŒä¸‹ä½ATï¼‰",
"BBï¼ˆ2å›å‰ãŒä¸‹ä½ATï¼‰"
];

const cols = ["å„ªé‡","å„ªé‡BB","å„ªé‡REG","åœ°ç„"];

function createTable(){
  const tbody = document.getElementById("tableBody");
  tbody.innerHTML = "";

  rows.forEach((r,index)=>{
    let rowHTML = `<tr><td>${rowLabels[index]}</td>`;

    cols.forEach(c=>{
      const id = r+"_"+c;
      rowHTML += `
      <td>
        <div id="${id}">0</div>
        <button class="plus" onclick="confirmSend('${r}','${c}')">ï¼‹</button>
      </td>`;
    });

    rowHTML += `</tr>`;
    tbody.innerHTML += rowHTML;
  });
}

function confirmSend(category,type){
  if(confirm(`${category} / ${type} ã‚’è¿½åŠ ã—ã¾ã™ã‹ï¼Ÿ`)){
    send(category,type);
  }
}

async function send(category,type){

  await fetch(GAS_URL,{
    method:"POST",
    body:JSON.stringify({
      category:category,
      type:type,
      value:1
    })
  });

  loadData();
}

async function loadData(){
  const res = await fetch(GAS_URL);
  const data = await res.json();

  rows.forEach(r=>{
    cols.forEach(c=>{
      const key = r+"_"+c;
      const count = data[key] || 0;
      document.getElementById(key).innerText = count;
    });
  });
}

createTable();
loadData();

</script>
</body>
</html>

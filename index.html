<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ¤œè¨¼ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼</title>

<style>
body{
  font-family:sans-serif;
  background:#111;
  color:white;
  margin:0;
  padding:5px;
  font-size:12px;
}
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  border:1px solid #333;
  padding:4px;
  text-align:center;
}
button{
  padding:4px 6px;
  margin:2px;
  border:none;
  border-radius:4px;
}
.plus{background:#28a745;color:white;}
.minus{background:#dc3545;color:white;}
.refresh{
  background:#007bff;
  color:white;
  width:100%;
  padding:8px;
  margin:5px 0;
}
</style>
</head>
<body>

<h3>æ¤œè¨¼ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ï¼ˆå…¨ä½“åˆç®—ï¼‰</h3>
<button class="refresh" onclick="loadData()">ğŸ”„ æ›´æ–°</button>

<table>
<tr>
<th>çŠ¶æ…‹</th>
<th>å„ªé‡</th>
<th>å„ªé‡(BB)</th>
<th>å„ªé‡(reg)</th>
<th>åœ°ç„</th>
<th>åˆè¨ˆ</th>
</tr>
<tbody id="tableBody"></tbody>
</table>

<script>

const GAS_URL = "ã“ã“ã«Apps Scriptã®URLã‚’è²¼ã‚‹";

const rows = [
"å½é©å‘½ï¼ˆäºŒå›å‰å½é©å‘½orä¸‹ä½ATã§ãªã„ï¼‰",
"å½é©å‘½ï¼ˆ2å›å‰ãŒå½é©å‘½ï¼‰",
"å½é©å‘½ï¼ˆ2å›å‰ãŒä¸‹ä½ATï¼‰",
"ä¸‹ä½ATï¼ˆäºŒå›å‰å½é©å‘½orä¸‹ä½ATã§ãªã„ï¼‰",
"BBï¼ˆäºŒå›å‰å½é©å‘½orä¸‹ä½ATã§ãªã„ï¼‰",
"ä¸‹ä½ATå¾Œï¼ˆ2å›å‰ãŒå½é©å‘½ï¼‰",
"BBï¼ˆ2å›å‰ãŒå½é©å‘½ï¼‰",
"ä¸‹ä½ATå¾Œï¼ˆï¼’å›å‰ãŒä¸‹ä½ATï¼‰",
"BBï¼ˆ2å›å‰ãŒä¸‹ä½ATï¼‰"
];

const cols = ["å„ªé‡","å„ªé‡ï¼ˆBBï¼‰","å„ªé‡(reg)","åœ°ç„"];

function createTable(){
  const tbody = document.getElementById("tableBody");
  tbody.innerHTML = "";
  rows.forEach(r=>{
    let rowHTML = `<tr><td>${r}</td>`;
    cols.forEach(c=>{
      const id = r+"_"+c;
      rowHTML += `
      <td>
        <div id="${id}">0</div>
        <button class="plus" onclick="send('${r}','${c}',1)">ï¼‹</button>
        <button class="minus" onclick="send('${r}','${c}',-1)">ï¼</button>
      </td>`;
    });
    rowHTML += `<td id="${r}_total">0</td></tr>`;
    tbody.innerHTML += rowHTML;
  });
}

async function send(category,type,value){
  await fetch(GAS_URL,{
    method:"POST",
    body:JSON.stringify({
      category:category,
      type:type,
      value:value
    })
  });
  loadData();
}

async function loadData(){
  const res = await fetch(GAS_URL);
  const data = await res.json();

  rows.forEach(r=>{
    let rowTotal = 0;
    cols.forEach(c=>{
      const key = r+"_"+c;
      const count = data[key] || 0;
      document.getElementById(key).innerText = count;
      rowTotal += count;
    });
    document.getElementById(r+"_total").innerText = rowTotal;
  });
}

createTable();
loadData();

</script>
</body>
</html>


</script>
</body>
</html>
